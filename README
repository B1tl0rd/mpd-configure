README for mpd-configure
========================

The `mpd-configure` script creates a valid mpd configuration file
optimised for bit perfect playback of high resolution digital audio
files.


Background
----------

I created this script in an attempt to create a network booted,
hardware independent audiophile streaming audio player using [Music
Player Daemon (MPD)](http://www.musicpd.org/) running as a [Linux
Terminal Server Project (LTSP)](http://www.ltsp.org/) client, see the
article [How to setup a bit-perfect digital audio streaming client
with free software (with LTSP and
MPD)](http://www.lacocina.nl/artikelen/how-to-setup-a-bit-perfect-digital-audio-streaming-client-with-free-software-with-ltsp-and-mpd).

However, the script can be used on any computer running the mpd
daemon. See the article [How to turn Music Player Daemon (mpd) into an
audiophile music
player](http://www.lacocina.nl/artikelen/mpd-configure-audiophile).


Manual usage with a fixed installation
--------------------------------------

For systems with a fixed configuration --eg a PC with a locally
installed mpd, connected to a DAC-- the script may be invoked
manually:

    ./mpd-configure


This will create the file `.mpdconf` in the current users home directory. `mpd` can than be started and told to use this configuration file:

    mpd ~/.mpdconf


Alternatively, the resulting configuration file can be copied to the
system wide mpd configuration file when you want to run mpd as a
system daemon:

    sudo cp ~/.mpdconf /etc/mpd.conf
    sudo service mpd restart


More dynamic environments
-------------------------

In dynamic environments --for example a network booted ltsp client,
which hardware may be altered each boot, connected to whatever DAC--
the script should be put in a logon script or an init script.

### LTSP-specific auto logon sample

For my LTPS-environment I therefore copy the script directory to the
home directory of the auto logon user specified in
`/var/lib/tftpboot/ltsp/i386/lts.conf` and edit it's `~/.profile` to
run the script and start `mpd` using the script generated
`~/.mpdconf`, ie:

    ~/mpd-configure/mpd-configure && mpd ~/.mpdconf


Configuration
-------------


### General parameters


`DEBUG`
Output values of variables to stdout.

- commented out: disabled (Default).
- `1`: enabled.


`DRYRUN`
Do not actually modify anything, eg. write to configuration file and
set volume controls.

- commentend out: disabled (Default).
- `1`: enabled


### Paths

See `man mpd.conf` for explanation.

`MPD_MUSICDIR`
The path to the directory where the music is stored. 

- commented out: use `$HOME/$XDG_MUSIC_DIR` if exists and specified in
  `~/.config/user-dirs.conf`, otherwise use `$HOME` (Default).
- `/some/path`: use the path specified.

`MPD_USERHOMEDIR`
The path to the directory which holds the mpd configuration and run
time files.

- commented out: use `$HOME/.mpd` if it exists (Default).
- `/some/path`: use the path specified.


`MPD_CONFFILE`
Path to where the generated mpd configuration file will be written.


- commented out: Use `$MPD_USERHOMEDIR/.mpdconf` as the path (Default).
- `/some/path/mpd.conf`: use the path specified.


### Alsa and sound

`PREFERREDALSADEVICE`
This should contain a unique portion of the string returned by

    LANG=C aplay -l | grep ^card

If for example the output is like this:


    card 1: SB [HDA ATI SB], device 0: ALC662 rev1 Analog [ALC662 rev1 Analog]
    card 1: SB [HDA ATI SB], device 1: ALC662 rev1 Digital [ALC662 rev1 Digital]

... you could use one of the following values to match the second line
(which in this example matches the alsa `hw:1,1` interface, eg. the
second interface of the second sound card):

    ALC662 rev1 Digital
    Digital

When you have one USB Audio device attached to your computer the
following string will do fine:

 
    'USB Audio'

- `USB Audio`: use the first available USB DAC (Default).
- `Some string`: use the (first) interface which matches the specified string.


`RESETVOLUME`
Enable setting the volume control of the sound card to the value of
`MASTERVOLUME`.

- `1`: enabled (Default).
- `0`: disabled.

`MASTERVOLUME`	
The level in dB or % of the volume of the `ALSADEVICE` to be set when
`RESETVOLUME` is enabled.

In dB: ranging from `-110` (silent) to `0` (fully open); ie: 

    '0db'
    '-10dB'

In %: ranging from `0` (silent) to `100` (fully open); ie:

    '100%'
    '90%'

- `0dB` or commented out: Set the volume to 0dB, eg. fully open (Default).
- other value: Use the value specified.


### Network parameters

`MPD_HOST`
The hostname or ip-address you want mpd to bind to.

- `0.0.0.0` or commented out: Bind to any address currently used by the computer (Default).
- other ip address or hostname: use the value specified.

`ENABLE_LASTFM`
Create a playlist plugin section for LastFM using `LASTFM_USERNAME`
and `LAST_PASSWORD`.

- commented out: disabled (Default).
- `1`: enabled.

`ENABLE_ZEROCONF`
Enable zeroconf configuration using the script generated name
`$ALSADEVICELABEL through MPD` name for upnp discovery.

commented out: disabled (Default)
`1`: enabled. 



Reference
---------

- [Music Player Daemon (MPD)](http://mpd.wikia.com/)
- [Linux Terminal Server Project (LTSP)](http://www.ltsp.org/)
- [How to setup a bit-perfect digital audio streaming client
  with free software (with LTSP and MPD)](http://www.lacocina.nl/artikelen/how-to-setup-a-bit-perfect-digital-audio-streaming-client-with-free-software-with-ltsp-and-mpd)

