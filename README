README for mpd-configure
========================

Background
----------

I created this script in an attempt to create a audiophile streaming
audio player using [Music Player Daemon
(MPD)](http://www.musicpd.org/) running as a [Linux Terminal Server
Project (LTSP)](http://www.ltsp.org/) client, but it can be used on
any computer running the mpd daemon.

The scripts creates a valid mpd configuration file based on the
settings in `mpdconfigure.conf`.

See the article [How to setup a bit-perfect digital audio streaming client
  with free software (with LTSP and MPD)](http://www.lacocina.nl/artikelen/how-to-setup-a-bit-perfect-digital-audio-streaming-client-with-free-software-with-ltsp-and-mpd).


Manual usage with a fixed installation
--------------------------------------

For systems with a fixed configuration --eg a PC with a locally
installed mpd, connected to a DAC-- the script may be invoked
manually:

    ./mpd-configure


This will create the file `.mpdconf` in the current directory. `mpd` can
than be started and told to use this configuration file:

    mpd .mpdconf


Alternatively, the resulting configuration file can be copied to the
system wide mpd configuration file:

    sudo cp .mpdconf /etc/mpd.conf


More dynamic environments
-------------------------

In dynamic environments --for example a network booted ltsp client,
which hardware may be altered each boot, connected to whatever DAC--
the script should be put in a logon script or an init script.

### LTSP-specific auto logon sample

For my LTPS-environment I therefore copy the script directory to the
home directory of the auto logon user specified in
`/var/lib/tftpboot/ltsp/i386/lts.conf` and edit it's `~/.profile` to
run the script and start `mpd` using the script generated
`~/.mpdconf`, ie:

    ~/mpd-configure/mpd-configure && mpd ~/.mpdconf



Configuration
-------------


### General parameters


`DEBUG`           Set to 1 to output values of variables in
                  terminal.
		  Default: commented (do not show DEBUG information)

`DRYRUN`	  Set to 1 to not write to conffile or set
		  volume controls.
		  Default: commented (do write to conffile and set
		  volume controls).

### Paths


See `man mpd.conf` for explanation.

`MPD_MUSICDIR`    Set to a valid directory path. 
		  Default: `$HOME/$XDG_MUSICDIR`

`MPD_USERHOMEDIR` Set to a valid directory path.
		  Default: `$HOME/.mpd`

`MPD_CONFFILE`	  Set to a valid file path.
		  Default: `$MPD_USERHOMEDIR/.mpdconf`


### Alsa and sound

`PREFERREDALSADEVICE` This should contain a unique portion of the string
 		returned by `LANG=C aplay -l | grep ^card`. If for
 		example the output is like this:

		 card 1: SB [HDA ATI SB], device 0: ALC662 rev1 Analog [ALC662 rev1 Analog]
		 card 1: SB [HDA ATI SB], device 1: ALC662 rev1 Digital [ALC662 rev1 Digital]

You could use one of the following values to match the second line (`hw:1,1`):

    'ALC662 rev1 Digital'
    'Digital'

When you have one USB Audio device attached to your computer the following string will do fine:

 
    'USB Audio'

Default: `USB Audio`: use the first available USB DAC


`RESETVOLUME`	Set to `1` to set the volume to `MASTERVOLUME`.
		Default: `1` set the volume

`MASTERVOLUME`	Specify the level in dB or % to set the volume of
		the `ALSADEVICE` when `RESETVOLUME` is enabled.

In dB: ranging from `-110` (silent) to `0` (fully open); ie: 

    '0db'
    '-10dB'

In %: ranging from `0` (silent) to `100` (fully open); ie:

    '100%'
    '90%'

Default: `0dB` set the volume to 0dB -- fully open


### Network parameters

`MPD_HOST`	  Set the hostname or ip-address you want mpd to bind to.
		  Default: `0.0.0.0` (bind to any address)


`ENABLE_LASTFM`   Set to `1` to create a playlist plugin section for
	 	  LastFM using `LASTFM_USERNAME` and `LAST_PASSWORD`.
		  Default: commented (do not create a playlist
		  section for LastFM)

`ENABLE_ZEROCONF` Set to `1` to enable zeroconf.
		  Default: commented (do not create a zeroconf section)




Reference
---------

- [Music Player Daemon (MPD)](http://mpd.wikia.com/)
- [Linux Terminal Server Project (LTSP)](http://www.ltsp.org/)
- [How to setup a bit-perfect digital audio streaming client
  with free software (with LTSP and MPD)](http://www.lacocina.nl/artikelen/how-to-setup-a-bit-perfect-digital-audio-streaming-client-with-free-software-with-ltsp-and-mpd)

